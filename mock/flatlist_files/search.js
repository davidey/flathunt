gumtree.GumExpandList=function(B){if(!(this instanceof (gumtree.GumExpandList))){return new gumtree.GumExpandList(B)}var I=this,J=gumtree.utils,A=B.selector,E=B.scrollSelector||A,H=J.get(".expand-tree","*",A)[0],F=J.get(".contract-tree","*",A)[0],C=J.events.addEvent,D=function(){var K=J.get("*","li",A),M,L,N=[];for(M=0,L=K.length;M<L;M++){if(H&&K[M]!==H.parentNode&&K[M]!==F.parentNode){N.push(K[M])}}return N}(),G=D.length;if(H){this.scrollWrapper=E;E=B.scrollSelector||A,this.expandTriggerContainer=H.parentNode;this.contractTriggerContainer=F.parentNode;this.optionalItems=function(){var L,K,M=[];for(L=0,K=G;L<K;L++){if(D[L].className.indexOf("js-show")===-1){M.push(D[L])}}return M}();this._events={showAll:function(K){I.showAll(K)},showDefault:function(K){I.showDefault(K)}};C(H,"click",I._events.showAll,true);C(F,"click",I._events.showDefault,true)}this.callbacks=B.callbacks||[]};gumtree.GumExpandList.prototype.showItem=function(B,A){B.className=B.className.replace("js-hide","js-show");if(A){this.processCallbacks()}};gumtree.GumExpandList.prototype.processCallbacks=function(){for(var B=0,A=this.callbacks.length;B<A;B++){var C=this.callbacks.pop();C()}};gumtree.GumExpandList.prototype.hideItem=function(B,A){B.className=B.className.replace("js-show","js-hide");if(A){this.processCallbacks()}};gumtree.GumExpandList.prototype.showAll=function(G){var C=10,B=this,D=0;for(var E=0,A=this.optionalItems.length;E<A;E++){var F=B.optionalItems[E];(function(I,H){setTimeout(function(){B.showItem(I)},H)}(F,D));D=D+C}setTimeout(function(){B.hideItem(B.expandTriggerContainer);B.showItem(B.contractTriggerContainer,true)},D);if(G.preventDefault){G.preventDefault()}else{G.returnValue=false}};gumtree.GumExpandList.prototype.showDefault=function(F){var B=1,A=this,C=0;for(var D=this.optionalItems.length;D>0;D--){var E=A.optionalItems[D-1];A.hideItem(E)}A.showItem(A.expandTriggerContainer);A.doPositionReset();A.hideItem(A.contractTriggerContainer,true);if(F.preventDefault){F.preventDefault()}else{F.returnValue=false}};gumtree.GumExpandList.prototype.doPositionReset=function(){var A=this;if(!$g.isElementInViewport(A.scrollWrapper)){A.scrollToWrapper()}};gumtree.GumExpandList.prototype.scrollToWrapper=function(){var A=$g.elementViewportPosition(this.scrollWrapper);window.scrollTo(A.x,A.y)};(function(H){if(H.fn.dotdotdot){return }H.fn.dotdotdot=function(U){if(this.length==0){B(true,'No element found for "'+this.selector+'".');return this}if(this.length>1){return this.each(function(){H(this).dotdotdot(U)})}var Q=this;if(Q.data("dotdotdot")){Q.trigger("destroy.dot")}Q.bind_events=function(){Q.bind("update.dot",function(X,Z){X.preventDefault();X.stopPropagation();S.maxHeight=(typeof S.height=="number")?S.height:N(Q);S.maxHeight+=S.tolerance;if(typeof Z!="undefined"){if(typeof Z=="string"||Z instanceof HTMLElement){Z=H("<div />").append(Z).contents()}if(Z instanceof H){V=Z}}R=Q.wrapInner('<div class="dotdotdot" />').children();R.empty().append(V.clone(true)).css({"height":"auto","width":"auto","border":"none","padding":0,"margin":0});var Y=false,W=false;if(P.afterElement){Y=P.afterElement.clone(true);P.afterElement.remove()}if(J(R,S)){if(S.wrap=="children"){W=D(R,S,Y)}else{W=L(R,Q,R,S,Y)}}R.replaceWith(R.contents());R=null;if(H.isFunction(S.callback)){S.callback.call(Q[0],W,V)}P.isTruncated=W;return W}).bind("isTruncated.dot",function(X,W){X.preventDefault();X.stopPropagation();if(typeof W=="function"){W.call(Q[0],P.isTruncated)}return P.isTruncated}).bind("originalContent.dot",function(X,W){X.preventDefault();X.stopPropagation();if(typeof W=="function"){W.call(Q[0],V)}return V}).bind("destroy.dot",function(W){W.preventDefault();W.stopPropagation();Q.unwatch().unbind_events().empty().append(V).data("dotdotdot",false)});return Q};Q.unbind_events=function(){Q.unbind(".dot");return Q};Q.watch=function(){Q.unwatch();if(S.watch=="window"){var Y=H(window),X=Y.width(),W=Y.height();Y.bind("resize.dot"+P.dotId,function(){if(X!=Y.width()||W!=Y.height()||!S.windowResizeFix){X=Y.width();W=Y.height();if(O){clearInterval(O)}O=setTimeout(function(){Q.trigger("update.dot")},10)}})}else{T=I(Q);O=setInterval(function(){var Z=I(Q);if(T.width!=Z.width||T.height!=Z.height){Q.trigger("update.dot");T=I(Q)}},100)}return Q};Q.unwatch=function(){H(window).unbind("resize.dot"+P.dotId);if(O){clearInterval(O)}return Q};var V=Q.contents(),S=H.extend(true,{},H.fn.dotdotdot.defaults,U),P={},T={},O=null,R=null;P.afterElement=C(S.after,Q);P.isTruncated=false;P.dotId=K++;Q.data("dotdotdot",true).bind_events().trigger("update.dot");if(S.watch){Q.watch()}return Q};H.fn.dotdotdot.defaults={"ellipsis":"... ","wrap":"word","lastCharacter":{"remove":[" ",",",";",".","!","?"],"noEllipsis":[]},"tolerance":0,"callback":null,"after":null,"height":null,"watch":false,"windowResizeFix":true,"debug":false};var K=1;function D(R,V,U){var T=R.children(),O=false;R.empty();for(var Q=0,P=T.length;Q<P;Q++){var S=T.eq(Q);R.append(S);if(U){R.append(U)}if(J(R,V)){S.remove();O=true;break}else{if(U){U.remove()}}}return O}function L(R,Q,b,S,P){var W=R.contents(),X=false;R.empty();var Z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var Y=0,U=W.length;Y<U;Y++){if(X){break}var V=W[Y],O=H(V);if(typeof V=="undefined"){continue}R.append(O);if(P){var T=(R.is(Z))?"after":"append";R[T](P)}if(V.nodeType==3){if(J(b,S)){X=E(O,Q,b,S,P)}}else{X=L(O,Q,b,S,P)}if(!X){if(P){P.remove()}}}return X}function E(P,R,c,S,O){var a=false,Y=P[0];if(typeof Y=="undefined"){return false}var Z=(S.wrap=="letter")?"":" ",b=G(Y).split(Z),W=-1,d=-1,X=0,Q=b.length-1;while(X<=Q){var T=Math.floor((X+Q)/2);if(T==d){break}d=T;A(Y,b.slice(0,d+1).join(Z)+S.ellipsis);if(!J(c,S)){W=d;X=d}else{Q=d}}if(W!=-1){var V=b.slice(0,W+1).join(Z);a=true;while(H.inArray(V.slice(-1),S.lastCharacter.remove)>-1){V=V.slice(0,-1)}if(H.inArray(V.slice(-1),S.lastCharacter.noEllipsis)<0){V+=S.ellipsis}A(Y,V)}else{var U=P.parent();P.remove();$n=U.contents().eq(-1);a=E($n,R,c,S,O)}return a}function J(P,O){return P.innerHeight()>O.maxHeight}function I(O){return{"width":O.innerWidth(),"height":O.innerHeight()}}function A(P,O){if(P.innerText){P.innerText=O}else{if(P.nodeValue){P.nodeValue=O}else{if(P.textContent){P.textContent=O}}}}function G(O){if(O.innerText){return O.innerText}else{if(O.nodeValue){return O.nodeValue}else{if(O.textContent){return O.textContent}else{return""}}}}function C(O,P){if(typeof O=="undefined"){return false}if(!O){return false}if(typeof O=="string"){O=H(O,P);return(O.length)?O:false}if(typeof O=="object"){return(typeof O.jquery=="undefined")?false:O}return false}function N(Q){var R=Q.innerHeight(),P=["paddingTop","paddingBottom"];for(z=0,l=P.length;z<l;z++){var O=parseInt(Q.css(P[z]),10);if(isNaN(O)){O=0}R-=O}return R}function B(P,O){if(!P){return false}if(typeof O=="string"){O="dotdotdot: "+O}else{O=["dotdotdot:",O]}if(window.console&&window.console.log){window.console.log(O)}return false}var M=H.fn.html;H.fn.html=function(O){if(typeof O!="undefined"){if(this.data("dotdotdot")){if(typeof O!="function"){return this.trigger("update",[O])}}return M.call(this,O)}return M.call(this)};var F=H.fn.text;H.fn.text=function(P){if(typeof P!="undefined"){if(this.data("dotdotdot")){var O=H("<div />");O.text(P);P=O.html();O.remove();return this.trigger("update",[P])}return F.call(this,P)}return F.call(this)}})(jQuery);gumtree.init.search.locationTree=function(){var B=document.getElementById("sidebar-locations"),A=gumtree.utils.get("*","ul",B)[0];return new gumtree.GumExpandList({selector:A,scrollSelector:B})};gumtree.init.search.categoryTree=function(){var A=document.getElementById("sidebar-categories"),B=gumtree.utils.get("*","ul",A)[0];return new gumtree.GumExpandList({selector:B,scrollSelector:A})};gumtree.init.search.sidebarFoldState=function(){new gumtree.GumTabManager({triggerContainers:"#sidebar-locations>a",panels:"#sidebar-locations>div>ul",animInSpeed:200,animOutSpeed:200,selfClosing:true,panelClosing:true});new gumtree.GumTabManager({triggerContainers:"#sidebar-categories>a",panels:"#sidebar-categories>div>ul",animInSpeed:200,animOutSpeed:200,selfClosing:true,panelClosing:true});new gumtree.GumTabManager({triggerContainers:"#search-filters>a",panels:"#search-filters>form",animInSpeed:200,animOutSpeed:200,selfClosing:true,panelClosing:true})};gumtree.init.search.placePaginationPageSelect=function(){var A=document.getElementById("pag-pager-trigger"),E=document.getElementById("pag-pager"),G,F,C,B=gumtree.utils,D=B.events.addEvent;if(E){document.body.appendChild(E);G=function(){var H=B.elementViewportPosition(A);E.style.position="absolute";E.style.top=H.y+"px";E.style.left=H.x+"px"};F=function(){E.style.display="block";A.className=A.className+" active"};C=function(){E.style.display="none";A.className=A.className.replace(" active","")};G();C();D(window,"resize",G);D(A,"mouseover",F);D(A,"mouseout",C);D(E,"mouseover",F);D(E,"mouseout",C)}};gumtree.init.search.showRightSkyskraper=function(){var G=false,H=false,C=document.getElementById("holder"),E=document.getElementById("ad-slot-top_skyscraper"),F=document.getElementById("ad-slot-mpu"),A=/ medium-display/gi,D=/ wide-display/gi,B=function(){var L=parseInt(C.innerWidth||C.clientWidth,10),M=(L>=1135),I=(L>=1280),K=document.documentElement.className.replace(A,"").replace(D,""),J;if(I&&!!F){document.documentElement.className=K+" wide-display";if(!H){H=true;J=gumtree.utils.get("*","iframe",F)[0];J.src=J.getAttribute("data-src")}}else{if(M&&!!E){document.documentElement.className=K+" medium-display";if(!G){G=true;J=gumtree.utils.get("*","iframe",E)[0];J.src=J.getAttribute("data-src")}}else{document.documentElement.className=K;return false}}return true};B();gumtree.utils.events.addEvent(window,"resize",B);$(window).resize()};gumtree.init.search.showExpiredNotice=function(){var A=document.getElementById("expired-vip-notice-placeholder");A.className="notice";A.innerHTML="<strong>Sorry, the ad you are looking for is no longer available.</strong> Please see similar ads below."};gumtree.init.search.truncateAdDescriptions=function(){$(".ad-description").dotdotdot({watch:true})};gumtree.init.search.truncateAdTitles=function(){$(".ad-title-text").dotdotdot({watch:true,ellipsis:"... ",noEllipsis:["-"]})};gumtree.init.search._onDomReady=(function(){var A=gumtree.init.search;A.sidebarFoldState();A.locationTree();A.categoryTree();A.showRightSkyskraper();A.placePaginationPageSelect();A.truncateAdTitles();A.truncateAdDescriptions()});domReady(function(){gumtree.init.search._onDomReady()})